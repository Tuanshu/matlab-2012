clear all;

Number_of_Loop=310;

y=[64 76 92 107 118 106 92 76];

z=[51 63 67 61 51 37 33 30];

dd=0.000000000001;

Merit_Goal=0;

Merit= @ (A,B,C,D,E,F,y,z) sum((A*y.^2+B*y.*z+C*z.^2+D*y+E*z+F).^2);

p=0;

A=1/900;

B=0;

C=1/400;

D=-1/5;

E=-1/4;

F=61/4;


while p<Number_of_Loop

    p=p+1;
    
    Error(p)=Merit(A,B,C,D,E,F,y,z);
    
    dA=(Merit_Goal-Merit(A,B,C,D,E,F,y,z))./((Merit(A+dd,B,C,D,E,F,y,z)-Merit(A,B,C,D,E,F,y,z))/dd);

    dB=(Merit_Goal-Merit(A,B,C,D,E,F,y,z))./((Merit(A,B+dd,C,D,E,F,y,z)-Merit(A,B,C,D,E,F,y,z))/dd);

    dC=(Merit_Goal-Merit(A,B,C,D,E,F,y,z))./((Merit(A,B,C+dd,D,E,F,y,z)-Merit(A,B,C,D,E,F,y,z))/dd);

    dD=(Merit_Goal-Merit(A,B,C,D,E,F,y,z))./((Merit(A,B,C,D+dd,E,F,y,z)-Merit(A,B,C,D,E,F,y,z))/dd);

    dE=(Merit_Goal-Merit(A,B,C,D,E,F,y,z))./((Merit(A,B,C,D,E+dd,F,y,z)-Merit(A,B,C,D,E,F,y,z))/dd);

    dF=(Merit_Goal-Merit(A,B,C,D,E,F,y,z))./((Merit(A,B,C,D,E,F+dd,y,z)-Merit(A,B,C,D,E,F,y,z))/dd);

    A=A+0.001*dA;

    B=B+0.001*dB;

    C=C+0.001*dC;

    D=D+0.001*dD;

    E=E+0.001*dE;

    F=F+0.001*dF;
   
    A(isnan(A))=1;
    
    B(isnan(B))=1;
    
    C(isnan(C))=1;
    
    D(isnan(D))=1;
    
    E(isnan(E))=1;
    
    F(isnan(F))=1;
    

end
plot(Error);
%clear y z
%syms y z
%solve(A*y.^2+B*y.*z+C*z.^2+D*y+E*z+F==0,z) 

%z=     (1933389929347563*y)/360434635913107072 + (576460752303423488*((1314506957523040558492838416838321*y)/664613997892457936451903530140172288 - (58452411633680263549963603063435847*y^2)/5444517870735015415413993718908291383296 - 27392423009408019503032803066417/324518553658426726783156020576256)^(1/2))/2815895593071149 + 145425508586822240/2815895593071149
 %or   (1933389929347563*y)/360434635913107072 - (576460752303423488*((1314506957523040558492838416838321*y)/664613997892457936451903530140172288 - (58452411633680263549963603063435847*y^2)/5444517870735015415413993718908291383296 - 27392423009408019503032803066417/324518553658426726783156020576256)^(1/2))/2815895593071149 + 145425508586822240/2815895593071149

plot(y,z,'*',y,(1933389929347563.*y)/360434635913107072 + (576460752303423488.*((1314506957523040558492838416838321.*y)/664613997892457936451903530140172288 - (58452411633680263549963603063435847.*y.^2)/5444517870735015415413993718908291383296 - 27392423009408019503032803066417/324518553658426726783156020576256).^(1/2))/2815895593071149 + 145425508586822240/2815895593071149,y,(1933389929347563.*y)/360434635913107072 - (576460752303423488.*((1314506957523040558492838416838321.*y)/664613997892457936451903530140172288 - (58452411633680263549963603063435847.*y.^2)/5444517870735015415413993718908291383296 - 27392423009408019503032803066417/324518553658426726783156020576256).^(1/2))/2815895593071149 + 145425508586822240/2815895593071149);